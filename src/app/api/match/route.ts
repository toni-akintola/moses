import { createBackendSupabaseClient } from "@/utils/supabase/server"
import { Candidate, Job, Match } from "../../../../types/types"
import { NextRequest, NextResponse } from "next/server"
import { MatchPayload } from "../../../../types/routes"
import { matchToCandidates, matchToJobs, storeMatch } from "@/app/api/match"

export async function POST(request: NextRequest) {
    const supabase = await createBackendSupabaseClient()
    const payload: MatchPayload = await request.json()
    console.log(payload)
    const embedding = [
        -0.028173547, 0.018069502, 0.018410437, 0.02603496, 0.03988928,
        -0.021168903, -0.026112445, 0.010351996, 0.0033628491, -0.0044243936,
        -0.029723246, -0.023106027, 0.010034308, 0.03579807, 0.01797652,
        0.065397345, -0.005191495, 0.01766658, -0.03012617, 0.029444302,
        0.013164702, -0.014846127, 0.053960554, -0.013327421, 0.0046374775,
        -0.048288655, 0.007655518, 0.053960554, 0.021153405, -0.04872257,
        0.013900809, -0.019262772, 0.0052883513, 0.007949961, 0.020502532,
        -0.004525124, 0.06276285, -0.013815576, 0.02924284, 0.004800196,
        -0.005981842, -0.027708637, 0.012506079, 0.04800971, 0.009716619,
        0.033101592, -0.033783462, -0.016209863, 0.010553457, 0.06942656,
        0.005513058, 0.008655075, -0.008980512, 0.062111977, -0.018611897,
        -0.048102688, 0.01797652, -0.019774172, -0.015411767, 0.021664806,
        -0.005702896, -0.023028543, 0.015125073, 0.06719499, -0.035147198,
        -0.01607039, -0.02278059, 0.011545265, -0.0016543048, 0.020115107,
        0.0052379863, 0.058640648, 0.020084113, 0.014652414, 0.026360398,
        0.003391906, -0.03037412, 0.010948631, -0.03285364, -0.049931336,
        0.009856092, 0.0232455, 0.0033396035, -0.06979849, -0.019882651,
        0.017341143, -0.03570509, -0.042399794, -0.019929143, -0.009995565,
        -0.05327869, -0.008027446, 0.017945526, -0.010065301, 0.0733318,
        -0.016240856, -0.04484832, -0.0047110883, 0.023276495, -0.0027759,
        -0.01957271, -0.024314793, 0.0377197, -0.028018577, -0.0030083552,
        0.04525124, -0.010026559, -0.02820454, -0.032047797, -0.023493452,
        -0.16154073, 0.0040330943, 0.0023148644, -0.019355753, -0.045747146,
        0.011111349, -0.04655299, -0.044507384, -0.025616542, -0.026577355,
        -0.022920063, -0.01565972, 0.007020141, -0.020982938, -0.012870259,
        0.0062026745, 0.008562093, -0.021509835, -0.03183084, -0.030358624,
        -0.03787467, -0.033039603, 0.037781686, -0.0119946785, -0.0402922,
        -0.00075402594, -0.048629586, -0.013358414, -0.0067799375,
        -0.0024524003, 0.010778164, 0.027646648, 0.008321889, 0.035178192,
        -0.037936658, -0.032047797, -0.040571146, 0.0335665, 0.019510724,
        0.016829742, -0.014048031, 0.0289329, -0.04122202, 0.0032776156,
        -0.011769972, -0.032264754, 0.0392694, 0.05414652, -0.01693822,
        -0.012126403, 0.017341143, -0.020502532, -0.02749168, 0.0035081333,
        -0.01379233, -0.005466567, 0.036541928, -0.009336943, -0.027879104,
        -0.008112679, -0.025353093, -0.05771083, -0.03362849, 0.027383199,
        0.0060477043, 0.007845356, -0.010305505, -0.008120428, 0.000103151906,
        0.03353551, -0.027011272, 0.046336032, -0.042802714, -0.029769737,
        -0.06115116, -0.07506747, 0.0036979716, 0.027305715, 0.005640908,
        0.010274511, 0.013583121, 0.008980512, 0.025632039, 3.4565575e-5,
        0.028251031, -0.031691365, -0.002477583, -0.04850561, -0.010987373,
        0.043174643, 0.028421499, -0.0153265335, 0.010793661, -0.0085853385,
        -0.03626298, -0.011808714, -0.030560084, -0.003037412, -0.03400042,
        -0.06775288, 0.047916725, 0.00836838, -0.014683408, 0.030312132,
        0.009848344, -0.019805167, -0.019138796, -0.03176885, -0.027646648,
        -0.08417971, -0.013125959, 0.066141196, 0.032698672, -0.03032763,
        0.0067915604, -0.0134513965, 0.025322098, -0.016535299, 0.034682285,
        -0.008438117, 0.030978503, 0.024469763, -0.00048718695, -0.052317873,
        -0.0052999742, 0.037843674, 0.014311479, 0.03063757, 0.019293765,
        0.083621815, -0.07010843, -0.018844353, 0.046429012, 0.043794524,
        0.04540621, 0.025957476, -0.027011272, -0.07965458, 0.044197444,
        0.009135482, 0.0031381426, 0.021525333, 0.00663659, -0.045065276,
        -0.027832612, -0.002433029, -0.01642682, 0.04190389, 0.04019922,
        0.015256797, 0.07463355, 0.022610124, -0.013280929, -0.0061368123,
        -0.051976938, -0.00036611664, -0.0041144537, -0.011584008, 0.0049009263,
        0.014125516, -0.0063189017, 0.06601722, 0.021416854, 0.002278059,
        -0.06359969, 0.005110136, 0.023230003, 0.008360632, 0.021013932,
        0.08089434, -0.026003966, 0.047358833, -0.015535743, 0.002557005,
        -0.0035565617, 0.005435573, 0.014784139, -0.0110183675, -0.005470441,
        -0.0058191237, -0.010816907, -0.006954279, 0.07004644, -0.019030316,
        0.011188834, 0.0034054657, 0.03285364, -0.015667466, 0.040726118,
        -0.01817798, 0.03895946, 0.02490368, 0.04376353, -0.033256564,
        -0.036696896, 0.0131724505, 0.046057086, -0.02226919, 0.013776833,
        0.0037134688, 0.020673, 0.041067053, -0.011553014, -0.018208975,
        -0.028142553, -0.050551213, 0.017620089, -0.005660279, 0.034589306,
        -0.036386956, 0.0061174408, 0.010863397, 0.0038141992, -0.04193488,
        -0.045127265, 0.003920741, 0.05625411, 0.016876234, 0.04159395,
        -0.022997549, -0.039548345, -0.027615655, -0.03198581, 0.017108688,
        0.026205428, -0.045034282, 0.0016911102, 0.021664806, 0.00056176627,
        0.021432351, -0.0125138275, -0.06328975, -0.06527337, -0.013567624,
        0.012358857, -0.01673676, 0.016225358, 0.021726795, -0.021215394,
        -0.0069620274, -0.019309262, 0.025818003, -0.051078115, 0.04190389,
        -0.011134595, -0.068310775, 0.015884425, -0.0039904774, -0.024144327,
        0.03995127, 0.03914542, 0.015202558, 0.03858753, -0.003360912,
        0.005017154, 0.010778164, -0.0043779025, -0.013288678, 0.024469763,
        -0.008050691, -0.0028533852, -0.040571146, 0.026375895, -0.020858962,
        -0.019619202, -0.0075392905, 0.0035410647, 0.0045173755, 0.04385651,
        0.014264989, 0.057493873, 0.04624305, -0.047916725, -0.003205942,
        0.031489905, 0.00898826, -0.0069000395, 0.021974746, 0.019231778,
        -0.00669083, 0.038215604, -0.025771512, 0.02742969, -0.049125493,
        0.02784811, 0.0046374775, 0.030017689, 0.039765302, 0.002878568,
        -0.035364155, 0.026980277, 0.00836838, 0.028220037, 0.0067760632,
        0.0028495109, -0.00233811, -0.008337386, 0.0325437, 0.003922678,
        -0.020115107, -0.001410227, -0.04332961, 0.03037412, -0.0012649427,
        0.021835273, -0.029428804, -0.006710201, 0.055479262, -0.014784139,
        -0.0032601815, -0.051171094, 0.0020824093, 0.024841692, -0.03765771,
        0.010987373, 0.03703783, 0.03595304, -0.09087441, -0.018023012,
        -0.0048621837, -0.012219384, 0.00041890328, -0.005637034, -0.029258337,
        0.008848787, -0.018286461, -0.0044321422, 0.03858753, -0.0060012136,
        0.03094751, 0.029676756, 0.0037464, -0.027956588, -0.031505402,
        -0.052100915, 0.020270076, 0.02603496, -0.013707097, 0.025384087,
        0.00873256, 0.011181085, -0.016287347, -0.03331855, 0.02541508,
        -0.014357971, 0.023493452, 0.009693374, 0.008895278, 0.0018606086,
        0.0096623795, 0.01286251, -0.021401357, -0.027026769, -0.0185964,
        0.013102714, -0.029010385, -0.019882651, 0.01642682, 0.014079025,
        -0.028127056, 0.018255467, -0.0058811116, -0.03223376, 0.037781686,
        0.012389852, 0.021153405, -0.02970775, -0.031598385, -0.030963007,
        -0.02711975, -0.00058840174, 0.0061174408, -0.042089853, 0.051945943,
        -0.0071169976, 0.053340673, -0.022920063, 0.025399584, -0.034341354,
        0.0433916, 0.010615445, -0.008786799, 0.025291104, -0.021060424,
        0.025353093, 0.023230003, 0.030079678, -0.07922067, -0.00421131,
        -0.05454944, 0.011514272, -0.014745396, -0.005083016, 0.019309262,
        0.010305505, -0.010011062, -0.02873144, 0.008244405, 0.026329404,
        0.0063615185, 0.010514715, -0.002539571, -0.03176885, -0.014303732,
        -0.034496322, 0.014838378, 0.016395826, 0.023725908, -0.012808271,
        0.001983616, 0.01735664, 0.0011642121, -0.0047304593, -0.0022586877,
        -0.0017443812, 0.005683525, -0.019665694, -0.018115994, 0.0118164625,
        -0.015442761, 0.017542604, -0.015450509, 0.06050029, -0.0002443199,
        -0.014660162, 0.004350783, -0.01972768, -0.022253692, -0.0024039722,
        0.021711297, -0.014295983, 0.03176885, 0.037471745, 0.023199009,
        0.0032563072, 0.029289331, 0.023075033, -0.021261884, -0.008066189,
        0.03858753, 0.020812472, -0.05885761, 0.031737857, -0.014218498,
        0.012568067, 0.018999323, 0.021106914, 0.0088642845, -0.013908558,
        -0.021618316, -0.002694541, 0.010855649, 0.058144744, 0.01487712,
        -0.018627394, 0.018441431, 0.0040330943, 0.0077097574, -0.0052573574,
        0.0067256982, -0.008631829, 0.012661049, -0.019169789, 0.008407122,
        0.050551213, 0.028049571, -0.02096744, 0.017403131, 0.017682077,
        0.0069852727, -0.028235534, -0.012568067, -0.0108479, 0.020037621,
        -0.047916725, -0.015690712, 0.04726585, -0.012103157, 0.003912993,
        -0.0065629794, 0.0043275375, 0.014660162, 0.018255467, -0.017604593,
        0.018580904, -0.016504304, -0.021525333, -0.025430577, -0.053805586,
        0.0021308376, 0.034992225, -0.02614344, 0.013978294, 0.023772398,
        -0.02138586, -0.029645761, -0.0028882534, 0.0011942376, 0.010654188,
        -0.013249936, -0.030870024, 0.0019148481, -0.015055336, -0.011707984,
        -0.0042190584, 0.031288445, -0.024314793, -0.012800522, -0.035457138,
        -0.040788107, -0.003934301, -0.01580694, -0.03291563, 0.05492137,
        0.01921628, 0.031288445, 0.013776833, 0.004974537, -0.030684061,
        0.01669027, 0.012831517, -0.012723037, 0.027011272, -0.019014819,
        0.006291782, 0.0047769505, 0.01731015, -0.022176208, 0.0040369686,
        -0.01012729, 0.014691156, 0.010274511, 0.02076598, -0.01746512,
        0.0058578663, 0.02536859, -0.033504516, -0.019169789, -0.024593739,
        -0.016721264, -0.028684948, -0.044507384, 0.0032136904, -0.010816907,
        0.0067179496, 0.0031187714, -0.027956588, -0.01766658, 0.00294443,
        0.02045604, -0.01870488, 0.05957047, 0.015008844, 0.014706654,
        0.01462142, 0.045344222, -0.0019080682, -0.007291339, -0.01518706,
        0.018487921, -0.016194366, 0.03238873, -0.0039091185, 0.0017608467,
        0.04453838, -0.032419726, -0.042027865, -0.031489905, 0.01947973,
        -0.015148317, -0.009887086, 0.019820664, -0.017868042, 0.019076807,
        -0.023168016, 0.00010012515, 0.03496123, -0.0134513965, 0.022067728,
        0.020285573, -0.006799309, 0.029211845, 0.050520223, 0.002107592,
        0.002632553, 0.0070743808, 0.006194926, 0.0051837466, -0.031226456,
        -0.04835064, -0.030498097, -0.020827968, -0.0071247458, -0.033814456,
        -0.045902114, -0.0033531634, -0.0022799962, 0.030451605, 0.048288655,
        -0.017046701, -0.009732116, 0.045499194, -0.04990034, -0.007012393,
        0.0013443647, 0.00821341, -0.0133119235, -0.00030001224, 0.009995565,
        -0.016023898, 0.02603496, 0.039021447, -0.02820454, -0.053495646,
        -0.042275816, -0.004354657, 0.02908787, -0.006229794, -0.014675659,
        -0.030467102, -0.00653586, -0.022408662, -0.02123089, -0.008693817,
        0.018968329, 0.009484164, -0.07816687, 0.0014082899, -0.029056875,
        -0.0130329775, -0.01007305, -0.076741144, 0.004331412, -0.010111793,
        -0.025260111, 0.002322613, 0.0035546245, 0.012444091, -0.03424837,
        0.026081452, -0.014892617, 0.015481504, -0.015318785, -0.031288445,
        0.0017521296, -0.013854318, 0.021881765, 0.009755362, 0.015899923,
        -0.012320115, 0.00836838, 0.03508521, 0.028282026, 0.028994888,
        0.017992018, 0.011483277, 0.042802714, 0.030250145, 0.021323873,
        -0.015543492, -0.003934301, -0.0026073703, -0.008314141, -0.008693817,
        0.044569373, 0.00020400347, -0.016163372, -0.017682077, 0.018023012,
        0.01580694, 0.042554762, -0.041655935, -0.023803392, -0.011615002,
        -0.0141100185, -0.004660723, 0.0010111793, 0.004602609, -0.012227133,
        -0.053371668, 0.016504304, 0.012265876, -0.015504749, 0.02185077,
        0.012126403, 0.008151422, 0.0046994654, -0.09428375, 0.0071208715,
        0.031009497, -0.08535748, -0.008608583, -0.0097011225, -0.03502322,
        0.013676103, -0.004939669, -0.011405792, 0.010243517, -0.03248171,
        0.0019874903, -0.0048311898, 0.0021134035, -0.032419726, 0.0020707867,
        0.016287347, -0.024066841, -0.0022896817, -0.058237728, -0.0017162928,
        -0.036696896, -0.00976311, -0.012777276, 0.026468877, 0.010491469,
        0.035922047, 0.0061445604, -0.009228463, -0.01669027, -0.005575046,
        0.033659484, 0.009251709, 0.0136915995, -0.043422595, 0.0025957476,
        -0.024299296, 0.008786799, -0.0096623795, -0.0013802015, -0.059663452,
        0.044507384, 0.014791886, 0.004060214, 0.024764206, -0.022129716,
        -0.0049164235, -0.0034306485, 0.026375895, 0.019433238, 0.0112973135,
        0.011165589, -0.029041378, -0.001627185, 0.014683408, -0.020130603,
        0.028793426, 0.03217177, -0.051945943, -0.006462249, 0.0017085443,
        -0.018069502, 0.0019894275, 0.038339578, 0.0055246805, -0.032667678,
        0.043205637, 0.012630056, 0.008748056, -0.0154660065, -0.012103157,
        -0.016473312, -0.015644222, 0.008120428, 0.0073494525, 0.0055518,
        -0.020378556, 0.024624733, -0.03207879, 0.0089650145, -0.030141665,
        0.040416177, 0.00960814, -0.01607039, -0.0004445702, 0.011274068,
        0.006357644, 0.0023109901, 0.024097836, 0.03781268, -0.0066714585,
        0.008554344, -0.0020688495, -0.0058268723, -0.0011584008, -0.014706654,
        0.002742969, -0.008980512, -0.0038180735, 0.018689383, -0.012599061,
        -0.00795771, 0.01751161, -0.0222072, -0.017434126, -0.012777276,
        0.008414871, 0.01642682, 0.002915373, 0.022966554, 0.04580913,
        0.008717063, 0.007911218, 0.0018547972, 0.03527117, 0.027801618,
        0.019030316, 0.014791886, 0.0140092885, 0.0057183933, 0.021633813,
        -0.038277593, 0.027414193, -2.2836888e-5, 0.045127265, 0.04484832,
        -0.036820874, -0.034341354, -0.012730786, 0.012219384, 0.018069502,
        -0.01477639, -0.020889957, 0.051481035, -0.02711975, 0.019433238,
        -0.0049048006, -0.015729455, -0.01937125, 0.026639344, -0.008476859,
        -0.025492566, -0.010111793, -0.017077694, 0.032946624, 0.010716176,
        0.017744066, -0.054735404, 0.011746726, 0.01906131, -0.01957271,
        -0.019619202, -0.007899596, 0.016364831, 0.027987583, 0.019758675,
        -0.023369476, -0.020580016, 0.056192122, 0.030513594, 0.051790975,
        -0.009964571, -0.02360193, -0.0091432305, -0.031954814, -0.0069155362,
        -0.04447639, -0.022346674, 0.03217177, 0.00560604, -0.0037212172,
        0.064033605, 0.029521786, -0.028498983, -0.013815576, -0.031226456,
        -0.03079254, 0.022129716, -0.005671902, 0.0117157325, 0.016504304,
        0.007643895, -0.00019794996, 0.025787009, 0.027166242, 0.02242416,
        -0.025601044, -0.020750483, 0.004652974, 0.023725908, 0.022796087,
        0.04230681, -0.0053115967, 0.026484374, -0.012916749, -0.009166475,
        0.030808037, 0.014342474, -0.013707097, -0.016504304, -0.036634907,
        0.013645109, -0.002510514, 0.028018577, 0.030265642, -0.04292669,
        -0.015001096, 0.008779051, 0.008647326, -0.015039839, -0.0025163253,
        -0.011421289, -0.03703783, -0.0125138275, 0.015977407, -0.0012639741,
        0.0050558965, -0.00014467903, -0.018456927, -0.0036611664, 0.0020979063,
        -0.015791444, 0.026267415, -0.009491913, 0.048536606, -0.009329194,
        -0.029335821, -0.026422385, 0.027662145, -0.031179965, -0.0039265524,
        0.009770859, -0.020549022, 0.034217376, -0.023911871, 0.0057610096,
        -0.023989357, 0.0061794287, -0.009670128, 0.016008401, -0.0030025437,
        0.023028543, -0.008500105, -0.004536747, -0.004835064, 0.035736084,
        0.027569164, -0.02009961, 0.03353551, -0.0051178844, 0.018828856,
        0.023896374, -0.015489251, 0.004955166, 0.01569846, 0.03988928,
        0.015721707, -0.0043779025, -0.0017240413, -0.0014509066, 0.015682964,
        0.05795878, 0.0025957476, 0.012312367, -0.012428594, -0.02711975,
        0.017372137, -0.009050248, 0.04314365, 0.017217167, -0.015636474,
        0.030188156, -0.0032253133, -0.037905663, 0.030017689, -0.011088104,
        0.018146988, 0.008624081, -0.020951945, -0.020177094, -0.018813359,
        0.033659484, 0.009127733, -0.021819776, -0.016178869, -0.012521576,
        -0.0060399557, -0.008267649, -0.048288655, 0.024051344, 0.021277381,
        0.0077136317, -0.012405349, -0.01627185, 0.002524074, -0.04890853,
        0.02360193, 0.047916725, 0.016907228, 0.018069502, 0.010685181,
        0.02820454, 0.020347562, -0.023013046, -0.008484608, -0.024655728,
        -0.023152519, -0.028746936, -0.007237099, -0.015008844, -0.014962354,
        0.0242838, -0.005683525, -0.0010412047, 0.014931359, -0.0024543374,
        0.004881555, -0.00014371047, -0.04103606, -0.012420846, 0.006183303,
        -0.005156627, -0.011390295, 0.0011758349, 0.012823768, 0.017046701,
        0.006183303, 0.0027778372, -0.025848996, -0.02009961, -0.010940882,
        0.0058462434, 0.032884635, 0.0044011483, -0.0072564706, -0.017728569,
        -0.007949961, -0.042089853, -0.019681191, 0.0088642845, -0.020440543,
        -0.022300184, 0.000883329, -0.011405792, 0.011754475, 0.017279156,
        0.007202231, 0.02654636, -0.030730551, 0.09236212, -0.013567624,
        -0.032760657, -0.015202558, 0.021664806, -0.012265876, -0.019557215,
        0.003391906, 0.005609914, 0.013769085, 0.023772398, 0.00032810055,
        0.017387634, -0.0030916515, 0.020595513, 0.0034790765, -0.0090425,
        0.012568067, 0.010568954, 0.015218054, 0.025663033, 0.00246596,
        0.029661259, -0.0060399557, -0.024066841, 0.019107802, -0.015613228,
        0.009964571, 0.044693347, 0.018286461, -0.031179965, -0.0070046443,
        0.02676332, 0.02200574, -0.014559432, 0.039610334, -0.030389618,
        -0.0043004174, 0.028421499, -0.00604383, -0.022470651, 0.0045522437,
        0.010793661, -0.003912993, -0.03042061, -0.016178869, -0.017108688,
        0.00070947205, -0.012033421, -0.0038141992, -0.009073494, 0.004792447,
        0.013598618, -0.025291104, -0.040571146, -0.020750483, 0.030079678,
        0.022997549, 0.009228463, 0.03057558, 0.0030083552, -0.008817793,
        0.03017266, 0.029676756, -0.0007704915, -0.023570938, 0.011041612,
        0.012715288, -0.007062758, 0.031691365, 0.0018228347, -0.02242416,
        -0.00604383, 0.026267415, -0.00027240822, 0.0185964, 0.037626717,
        -0.009739865, 0.013094965, 0.028220037, -0.047978714, -0.010646439,
        0.023013046, 0.007640021, 0.0021114664, -0.06291782, -0.022036735,
        0.009019254, -0.020425046, -0.004137699, -0.00898826, -0.046491,
        0.029041378, 0.021060424, 0.010460475, -0.017403131, -0.013606367,
        0.033070598, 0.0062801596, 0.000542395, 0.016039396, -0.009174224,
        -0.0050985133, 0.01177772, 0.004974537, -0.021199897, -0.009778608,
        -0.009879338, -0.005652531, 0.042492773, 0.004633603, 0.014815132,
        0.0433916, -0.010522463, 0.02191276, -0.030606575, -0.0088642845,
        0.019309262, 0.0073843207, -0.009980069, 0.028529977, -0.0014121642,
        0.01720167, -0.019510724, -0.0059430995, -0.010460475, 0.044445395,
        0.010925385, -0.00295799, -0.028096061, 0.019696688, 0.015481504,
        0.023075033, 0.032357737, 0.007640021, 0.016798748, 0.011971433,
        -0.012738534, -0.020673, 0.004397274, -0.025074147, -0.02185077,
        0.002063038, 0.009057997, 0.014644666, -0.024299296, 0.0031691366,
        -0.033070598, -0.0062530395, 0.008259901, 0.006741195, -0.0030935886,
        0.01307172, -0.024097836, 0.0031807593, -0.005853992, 0.012738534,
        0.055851188, -0.03740976, -0.0016513991, 0.020812472, 0.0061484347,
        -0.017480616, 0.0065900995, 0.002214134, 0.016085885, 0.0154660065,
        -0.015202558, 0.04035419, -0.009856092, 0.008453614, 0.021199897,
        0.054332484, 0.023230003, 0.008538847, -0.03141242, 0.020223586,
        -0.0027352206, -8.995525e-5, -0.009228463, -0.02784811, -0.05005531,
        -0.043980487, -0.00085088215, -0.00083829084, 0.0012416971, 0.028266529,
        -0.008259901, 0.017558102, 0.01322669, -0.0015613228, 0.011661492,
        -0.006741195, 0.010321002, 0.024252806, 0.026344901, 0.009329194,
        -0.021618316, 0.0027855858, 0.014729898, -0.008151422, 0.01611688,
        -0.020827968, 0.007884099, 0.019929143, 0.02045604, 0.0012339486,
        0.0057881298, -0.029676756, -0.025818003, -0.003221439, 0.019030316,
        0.016922724, -0.014055779, 0.037905663, -0.010499218, -0.007926716,
        0.026267415, 0.017992018, -0.013304175, 0.02200574, -0.039486356,
        0.02959927, -0.022749597, 0.02470222, 0.020642005, 0.027677642,
        0.0020010502, 0.023415968, -0.020192591, 0.021292878, 0.020951945,
        -0.021447849, -0.021959249, 0.0023206759, 0.013753587, 0.0051295073,
        0.018952832, 0.004149322, -0.0016223423, 0.021044927, 0.014683408,
        -0.0020843465, 0.0011332182, -0.005021028, 0.017930029, 0.012420846,
        -0.023137022, 0.01693822, 0.03139692, 0.01906131, 0.018952832,
        -0.019913645, -0.038866475, 0.009724367, -0.025508063, -0.036386956,
        0.0036049897, -0.024345787, -0.0201461, -0.008763554, -0.007973206,
        0.011638247, 0.005253483, 0.016008401, 0.02381889, 0.025601044,
        0.027181739, -0.010785912, 0.0023071158, 0.0005409422, -0.02970775,
        0.0039304267, 0.016876234, -0.013428151, -0.0030897143, -0.00043004175,
        0.022098722, 0.0077097574, -0.015690712, -0.013978294, -0.0017705323,
        -0.012459588, -0.007035638, 0.032946624, 0.012289121, -0.03787467,
        0.01627185, 0.031474408, 0.025229117, -0.010475973, 0.009654631,
        0.0034442083, 0.0043042917, 0.005145004, 0.039765302, -0.0131724505,
        0.024733212, 0.0034965107, 0.0185964, 0.018472424, -0.02278059,
        0.035457138, -0.02609695, -0.017248161, 0.037223794, 0.00681868,
        -0.0025589422, -0.0059857164, -0.0007462774, -0.0065552313, 0.027646648,
        0.02096744, 0.0044398904, 0.023586435, 0.010468224, 0.045995098,
        -0.0033279809, -0.0022916188, 0.036913853, 0.025074147, -0.0036359837,
        0.034434333, 0.016705766, 0.0042074355, 0.013645109, -0.00731071,
        0.014172006, 0.0030141666, 0.01183196, 0.014582678, 0.0035061964,
        0.017589096, -0.0062220455, -0.004288795, 0.011638247, 0.0067063267,
        -0.00986384, 0.009406679, 0.016132377, 0.0071208715, -0.0068457997,
        -0.032047797, -0.0010441104, -0.0064699976, 0.02680981, 0.037316777,
        -0.048474617, 0.019185286, 0.005919854, -0.04205886, 0.016674772,
        -0.04432142, 0.036139004, -0.0092827035, 0.0017143557, -0.010049805,
        0.0007501517, -0.016209863, 0.027569164, -0.051078115, 0.0066637103,
        -0.02448526, -0.0014615608, -0.0076129013, 0.031334933, 0.008631829,
        -0.03418638, -0.0012872196, 0.020905454, 0.004618106, -0.014280486,
        0.022842579, -0.01187845, -0.028963894, -0.013567624, -0.017232664,
        0.005028777, -0.0028572595, -0.03279165, 0.048784558, -0.01611688,
        0.004199687, -0.013335168, 0.008538847, 0.0011506523, -0.045437206,
        0.0013666417, -0.020161597,
    ]
    const profileID = payload.profileID

    // check to see if the request body includes an embedding
    if (!embedding || !profileID) return NextResponse.error()
    if (payload.candidate) {
        const matches = await matchToJobs(embedding)
        console.log(matches)
        return NextResponse.json({ matches })
    }
    if (!payload.jobID) return NextResponse.error()

    const rawMatches = await matchToCandidates(embedding)
    const matches = rawMatches.map(async (rawMatch: { rating: number }) => {
        const match: Match = {
            profile_id: profileID,
            job_id: "",
            employer_id: "",
            candidate_id: "",
            rating: rawMatch.rating,
        }
        await storeMatch(match)
    })

    return NextResponse.json({ matches })
}
